/* PublicaMundi Mapping API version 0.1.0 2014-12-03 */

!function(a,b){"use strict";var c={__namespace:"PublicaMundi"},d=null,e=null,f=[],g=null;c.LayerType={WMS:"WMS",WFS:"WFS",TILE:"Tile",GeoJSON:"GeoJSON",KML:"KML",GML:"GML",GPX:"GPX",CSV:"CSV",WCS:"WCS",WCPS:"WCPS"},c.version="0.0.1",c.define=function(b){if(b)for(var c=b.split("."),d=a,e=0;e<c.length;e++)c[e]&&("undefined"==typeof d[c[e]]&&(d[c[e]]={__namespace:c.slice(0,e+1).join(".")}),d=d[c[e]])};var h=function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&void 0!==b[c]&&(a[c]=b[c]);return a};c.Class=function(){for(var a,b,c=function(){"function"==typeof this.initialize&&this.initialize.apply(this,arguments)},d={},e=function(){},f=0,g=arguments.length;g>f;++f)"function"==typeof arguments[f]?(0===f&&g>1&&(b=arguments[f].prototype.initialize,arguments[f].prototype.initialize=e(),d=new arguments[f],d.constructor=c,void 0===b?delete arguments[f].prototype.initialize:arguments[f].prototype.initialize=b),a=arguments[f].prototype):a=arguments[f],h(d,a);return c.prototype=d,c.prototype.constructor=c,c};var i={};c.registerFrameworkResolver=function(a,b){return i.hasOwnProperty(a)?(console.log("Resolver for framework "+a+" already registered."),!1):(i[a]=b,!0)},c.resolveFramework=function(){for(var a in i)if(i[a]())return a;return null},c.isDefined=function(a){return"undefined"!=typeof a},c.isFunction=function(a){return"function"==typeof a},c.isObject=function(a){return"object"==typeof a},c.isClass=function(b){for(var c=b.split("."),d=a,e=0;e<c.length;e++){if(!c[e]||"undefined"==typeof d[c[e]])return!1;if(e===c.length-1&&"function"!=typeof d[c[e]])return!1;d=d[c[e]]}return!0},c.isArray=function(a){return Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a)},c.getQueryStringParameters=function(a){var b={};return a.replace(new RegExp("([^?=&]+)(=([^&#]*))?","g"),function(a,c,d,e){b[c]=e}),b},c.locator={_dependencies:[],_factories:[],register:function(a,b){var c=this._dependencies.indexOf(a);return 0>c?(this._dependencies.push(a),this._factories.push(b)):this._factories[c]=b,b},unregister:function(a){var b=this._dependencies.indexOf(a);b>=0&&(this._dependencies.splice(b,1),this._factories.splice(b,1))},resolve:function(a){var b=this._dependencies.indexOf(a);return 0>b?null:this._factories[b]},create:function(a,b){var c=this.resolve(a);return c?new c(b):null}},c.registry={_LayerTypeRegistry:[],registerLayerType:function(a){for(var b=null,d=0;d<this._LayerTypeRegistry.length;d++)if(this._LayerTypeRegistry[d].layer===a.layer&&this._LayerTypeRegistry[d].framework===a.framework){b=this._LayerTypeRegistry[d];break}b?b.type=a.type:(b={layer:a.layer,framework:a.framework,type:a.type},this._LayerTypeRegistry.push(b)),c.locator.register(a.type,a.factory)},resolveLayerType:function(a){for(var b=null,d=c.resolveFramework(),e=0;e<this._LayerTypeRegistry.length;e++)if(this._LayerTypeRegistry[e].layer===a&&this._LayerTypeRegistry[e].framework===d){b=this._LayerTypeRegistry[e];break}return b?b.type:null},createLayer:function(a){var b=this.resolveLayerType(a.type);return b?c.locator.create(b,a):null},getFactories:function(){return this._LayerTypeRegistry.map(function(a){return c.locator.resolve(a.type)})}},c._PM=a.PM,c.noConflict=function(){return a.PM===c&&("undefined"!=typeof this._PM?a.PM=this._PM:delete a.PM),this},d=jQuery("script").last().attr("src"),d=d.substring(0,d.lastIndexOf("/")+1),e=jQuery("script").last().data("library"),e||(e="ol"),c.ready=function(a){if(!c.isFunction(a))return void console.log("Argument for ready() is not a function.");if(c.resolveFramework()||(console.log("Loading scripts..."),b("<link/>",{rel:"stylesheet",type:"text/css",href:d+"lib/"+e+"/"+e+".css"}).appendTo("head"),f.push(d+"lib/"+e+"/"+e+".js"),f.push(d+"publicamundi."+e+".js")),0===f.length)a();else{var h=function(){g&&(console.log("["+g+"] has been loaded."),g=null),f.length>0?(g=f[0],f.shift(),b.ajax({url:g,dataType:"script",success:h,cache:!0})):a()};h()}},a.PublicaMundi=a.PM=c}(window,jQuery),function(a,b){"use strict";"undefined"!=typeof b&&(b.Map=b.Class({initialize:function(a){this._map=null,this._layers=[],this._control=null,this._viewbox="0,0,0,0",this._popup=null,a=a||{},a.target=b.isDefined(a.target)?a.target:null,a.projection=b.isDefined(a.projection)?a.projection:"EPSG:3857",a.center=b.isDefined(a.center)?a.center:[0,0],a.zoom=b.isDefined(a.zoom)?a.zoom:2},setExtent:function(){return this},_setViewBox:function(){return this},_getViewBox:function(){return this._viewbox},setLayerControl:function(){return this},getLayerControl:function(){return this._control},getMap:function(){return this._map},getOverlay:function(){return this._popup},setCenter:function(){return this},getCenter:function(){return null},setZoom:function(){return this},getZoom:function(){return null},getProjection:function(){return null},getTarget:function(){return null},getLayers:function(){return this._layers},_listen:function(){return null},createLayer:function(a){var c=null;switch(typeof a){case"string":var d=[".gson",".geojson"];d.some(function(b){return a.indexOf(b,a.length-b.length)})&&this.createLayer({type:b.LayerType.GeoJSON,url:a,projection:this.getProjection()});break;case"object":for(var e=b.registry.getFactories(),f=0;f<e.length;f++)if(a instanceof e[f]){c=a;break}c||(b.isDefined(a.projection)||(a.projection=this.getProjection()),c=b.registry.createLayer(a),c.setMap(this)),c?this.addLayer(c):console.log("Layer of type "+a.type+" is not supported.")}return c&&this._layers.push(c),c},addLayer:function(){}}),b.locator.register("PublicaMundi.Map",b.Map),b.map=function(a){return b.locator.create("PublicaMundi.Map",a)},b.configure=function(a,c,d){var e=b.map("string"==typeof a?{target:a}:a);return jQuery.getJSON(c,function(a){if(a.center&&e.setCenter(a.center),a.zoom&&e.setZoom(a.zoom),b.isArray(a.layers))for(var c=0;c<a.layers.length;c++)e.addLayer(a.layers[c]);b.isFunction(d)&&d.call(this,a)}),e})}(window,window.PublicaMundi),function(a,b){"undefined"!=typeof b&&(b.define("PublicaMundi"),b.Layer=b.Class({initialize:function(a){this._map=null,this._type=null,this._layer=null,this._extent=a.bbox||null,this._options=a||{}},setMap:function(a){this._map=a},getMap:function(){return this._map},getType:function(){return this._type},getLayer:function(){return this._layer},setLayerExtent:function(){return this._extent},getOptions:function(){return this._options},addToControl:function(){return null},update:function(){return null}}),b.locator.register("PublicaMundi.Layer",b.Layer))}(window,PublicaMundi);
//# sourceMappingURL=publicamundi.js.map